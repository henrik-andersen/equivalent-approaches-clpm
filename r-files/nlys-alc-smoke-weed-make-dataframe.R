
rm(list = ls())

# Set working directory
setwd("D:/Henrik/Seafile/Meine Bibliothek/data/NLYS/alcohol-cigarettes-marijuana")


new_data <- read.table('alc-smoke-weed.dat', sep=' ')
names(new_data) <- c('R0000100',
  'R0358200',
  'R0358600',
  'R0359100',
  'R0536300',
  'R0536401',
  'R0536402',
  'R1235800',
  'R1482600',
  'R2189600',
  'R2190400',
  'R2191300',
  'R3508700',
  'R3509500',
  'R3510400',
  'R4906800',
  'R4907600',
  'R4908500',
  'R6534300',
  'R6534900',
  'R6535700',
  'S0921800',
  'S0922400',
  'S0923300',
  'S2988500',
  'S2989100',
  'S2989800',
  'S4683100',
  'S4683900',
  'S4684800',
  'S6318600',
  'S6319500',
  'S6320400',
  'S8333600',
  'S8334000',
  'S8334400',
  'T0740400',
  'T0740800',
  'T0741200',
  'T2783900',
  'T2784300',
  'T2784700',
  'T4495600',
  'T4496000',
  'T4496400',
  'T6144500',
  'T6144900',
  'T6145300',
  'T7639000',
  'T7639400',
  'T7639800')


# Handle missing values

  new_data[new_data == -1] = NA  # Refused 
  new_data[new_data == -2] = NA  # Dont know 
  new_data[new_data == -3] = NA  # Invalid missing 
  new_data[new_data == -4] = NA  # Valid missing 
  new_data[new_data == -5] = NA  # Non-interview 


# If there are values not categorized they will be represented as NA

vallabels = function(data) {
  data$R0000100[1.0 <= data$R0000100 & data$R0000100 <= 999.0] <- 1.0
  data$R0000100[1000.0 <= data$R0000100 & data$R0000100 <= 1999.0] <- 1000.0
  data$R0000100[2000.0 <= data$R0000100 & data$R0000100 <= 2999.0] <- 2000.0
  data$R0000100[3000.0 <= data$R0000100 & data$R0000100 <= 3999.0] <- 3000.0
  data$R0000100[4000.0 <= data$R0000100 & data$R0000100 <= 4999.0] <- 4000.0
  data$R0000100[5000.0 <= data$R0000100 & data$R0000100 <= 5999.0] <- 5000.0
  data$R0000100[6000.0 <= data$R0000100 & data$R0000100 <= 6999.0] <- 6000.0
  data$R0000100[7000.0 <= data$R0000100 & data$R0000100 <= 7999.0] <- 7000.0
  data$R0000100[8000.0 <= data$R0000100 & data$R0000100 <= 8999.0] <- 8000.0
  data$R0000100[9000.0 <= data$R0000100 & data$R0000100 <= 9999.0] <- 9000.0
  data$R0000100 <- factor(data$R0000100, 
    levels=c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0), 
    labels=c("0",
      "1 TO 999",
      "1000 TO 1999",
      "2000 TO 2999",
      "3000 TO 3999",
      "4000 TO 4999",
      "5000 TO 5999",
      "6000 TO 6999",
      "7000 TO 7999",
      "8000 TO 8999",
      "9000 TO 9999"))
  data$R0358200[15.0 <= data$R0358200 & data$R0358200 <= 99.0] <- 15.0
  data$R0358200 <- factor(data$R0358200, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 99: 15+"))
  data$R0358600[15.0 <= data$R0358600 & data$R0358600 <= 99.0] <- 15.0
  data$R0358600 <- factor(data$R0358600, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 99: 15+"))
  data$R0359100[1.0 <= data$R0359100 & data$R0359100 <= 4.0] <- 1.0
  data$R0359100[5.0 <= data$R0359100 & data$R0359100 <= 9.0] <- 5.0
  data$R0359100[10.0 <= data$R0359100 & data$R0359100 <= 14.0] <- 10.0
  data$R0359100[15.0 <= data$R0359100 & data$R0359100 <= 19.0] <- 15.0
  data$R0359100[20.0 <= data$R0359100 & data$R0359100 <= 24.0] <- 20.0
  data$R0359100[25.0 <= data$R0359100 & data$R0359100 <= 29.0] <- 25.0
  data$R0359100 <- factor(data$R0359100, 
    levels=c(0.0,1.0,5.0,10.0,15.0,20.0,25.0,30.0), 
    labels=c("0",
      "1 TO 4",
      "5 TO 9",
      "10 TO 14",
      "15 TO 19",
      "20 TO 24",
      "25 TO 29",
      "30"))
  data$R0536300 <- factor(data$R0536300, 
    levels=c(0.0,1.0,2.0), 
    labels=c("No Information",
      "Male",
      "Female"))
  data$R0536401 <- factor(data$R0536401, 
    levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0), 
    labels=c("1: January",
      "2: February",
      "3: March",
      "4: April",
      "5: May",
      "6: June",
      "7: July",
      "8: August",
      "9: September",
      "10: October",
      "11: November",
      "12: December"))
  data$R1235800 <- factor(data$R1235800, 
    levels=c(0.0,1.0), 
    labels=c("Oversample",
      "Cross-sectional"))
  data$R1482600 <- factor(data$R1482600, 
    levels=c(1.0,2.0,3.0,4.0), 
    labels=c("Black",
      "Hispanic",
      "Mixed Race (Non-Hispanic)",
      "Non-Black / Non-Hispanic"))
  data$R2189600[15.0 <= data$R2189600 & data$R2189600 <= 99.0] <- 15.0
  data$R2189600 <- factor(data$R2189600, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 99: 15+"))
  data$R2190400[15.0 <= data$R2190400 & data$R2190400 <= 99.0] <- 15.0
  data$R2190400 <- factor(data$R2190400, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 99: 15+"))
  data$R2191300[1.0 <= data$R2191300 & data$R2191300 <= 4.0] <- 1.0
  data$R2191300[5.0 <= data$R2191300 & data$R2191300 <= 9.0] <- 5.0
  data$R2191300[10.0 <= data$R2191300 & data$R2191300 <= 14.0] <- 10.0
  data$R2191300[15.0 <= data$R2191300 & data$R2191300 <= 19.0] <- 15.0
  data$R2191300[20.0 <= data$R2191300 & data$R2191300 <= 24.0] <- 20.0
  data$R2191300[25.0 <= data$R2191300 & data$R2191300 <= 29.0] <- 25.0
  data$R2191300 <- factor(data$R2191300, 
    levels=c(0.0,1.0,5.0,10.0,15.0,20.0,25.0,30.0), 
    labels=c("0",
      "1 TO 4",
      "5 TO 9",
      "10 TO 14",
      "15 TO 19",
      "20 TO 24",
      "25 TO 29",
      "30"))
  data$R3508700[15.0 <= data$R3508700 & data$R3508700 <= 99.0] <- 15.0
  data$R3508700 <- factor(data$R3508700, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 99: 15+"))
  data$R3509500[15.0 <= data$R3509500 & data$R3509500 <= 99.0] <- 15.0
  data$R3509500 <- factor(data$R3509500, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 99: 15+"))
  data$R3510400[1.0 <= data$R3510400 & data$R3510400 <= 4.0] <- 1.0
  data$R3510400[5.0 <= data$R3510400 & data$R3510400 <= 9.0] <- 5.0
  data$R3510400[10.0 <= data$R3510400 & data$R3510400 <= 14.0] <- 10.0
  data$R3510400[15.0 <= data$R3510400 & data$R3510400 <= 19.0] <- 15.0
  data$R3510400[20.0 <= data$R3510400 & data$R3510400 <= 24.0] <- 20.0
  data$R3510400[25.0 <= data$R3510400 & data$R3510400 <= 29.0] <- 25.0
  data$R3510400 <- factor(data$R3510400, 
    levels=c(0.0,1.0,5.0,10.0,15.0,20.0,25.0,30.0), 
    labels=c("0",
      "1 TO 4",
      "5 TO 9",
      "10 TO 14",
      "15 TO 19",
      "20 TO 24",
      "25 TO 29",
      "30"))
  data$R4906800[20.0 <= data$R4906800 & data$R4906800 <= 999999.0] <- 20.0
  data$R4906800 <- factor(data$R4906800, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15",
      "16",
      "17",
      "18",
      "19",
      "20 TO 999999: 20+"))
  data$R4907600[15.0 <= data$R4907600 & data$R4907600 <= 999.0] <- 15.0
  data$R4907600 <- factor(data$R4907600, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 999: 15+"))
  data$R4908500[1.0 <= data$R4908500 & data$R4908500 <= 4.0] <- 1.0
  data$R4908500[5.0 <= data$R4908500 & data$R4908500 <= 9.0] <- 5.0
  data$R4908500[10.0 <= data$R4908500 & data$R4908500 <= 14.0] <- 10.0
  data$R4908500[15.0 <= data$R4908500 & data$R4908500 <= 19.0] <- 15.0
  data$R4908500[20.0 <= data$R4908500 & data$R4908500 <= 24.0] <- 20.0
  data$R4908500[25.0 <= data$R4908500 & data$R4908500 <= 29.0] <- 25.0
  data$R4908500 <- factor(data$R4908500, 
    levels=c(0.0,1.0,5.0,10.0,15.0,20.0,25.0,30.0), 
    labels=c("0",
      "1 TO 4",
      "5 TO 9",
      "10 TO 14",
      "15 TO 19",
      "20 TO 24",
      "25 TO 29",
      "30"))
  data$R6534300[20.0 <= data$R6534300 & data$R6534300 <= 999999.0] <- 20.0
  data$R6534300 <- factor(data$R6534300, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15",
      "16",
      "17",
      "18",
      "19",
      "20 TO 999999: 20+"))
  data$R6534900[15.0 <= data$R6534900 & data$R6534900 <= 999.0] <- 15.0
  data$R6534900 <- factor(data$R6534900, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 999: 15+"))
  data$R6535700[1.0 <= data$R6535700 & data$R6535700 <= 4.0] <- 1.0
  data$R6535700[5.0 <= data$R6535700 & data$R6535700 <= 9.0] <- 5.0
  data$R6535700[10.0 <= data$R6535700 & data$R6535700 <= 14.0] <- 10.0
  data$R6535700[15.0 <= data$R6535700 & data$R6535700 <= 19.0] <- 15.0
  data$R6535700[20.0 <= data$R6535700 & data$R6535700 <= 24.0] <- 20.0
  data$R6535700[25.0 <= data$R6535700 & data$R6535700 <= 29.0] <- 25.0
  data$R6535700 <- factor(data$R6535700, 
    levels=c(0.0,1.0,5.0,10.0,15.0,20.0,25.0,30.0), 
    labels=c("0",
      "1 TO 4",
      "5 TO 9",
      "10 TO 14",
      "15 TO 19",
      "20 TO 24",
      "25 TO 29",
      "30"))
  data$S0921800[20.0 <= data$S0921800 & data$S0921800 <= 999999.0] <- 20.0
  data$S0921800 <- factor(data$S0921800, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15",
      "16",
      "17",
      "18",
      "19",
      "20 TO 999999: 20+"))
  data$S0922400[15.0 <= data$S0922400 & data$S0922400 <= 999.0] <- 15.0
  data$S0922400 <- factor(data$S0922400, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 999: 15+"))
  data$S0923300[1.0 <= data$S0923300 & data$S0923300 <= 4.0] <- 1.0
  data$S0923300[5.0 <= data$S0923300 & data$S0923300 <= 9.0] <- 5.0
  data$S0923300[10.0 <= data$S0923300 & data$S0923300 <= 14.0] <- 10.0
  data$S0923300[15.0 <= data$S0923300 & data$S0923300 <= 19.0] <- 15.0
  data$S0923300[20.0 <= data$S0923300 & data$S0923300 <= 24.0] <- 20.0
  data$S0923300[25.0 <= data$S0923300 & data$S0923300 <= 29.0] <- 25.0
  data$S0923300 <- factor(data$S0923300, 
    levels=c(0.0,1.0,5.0,10.0,15.0,20.0,25.0,30.0), 
    labels=c("0",
      "1 TO 4",
      "5 TO 9",
      "10 TO 14",
      "15 TO 19",
      "20 TO 24",
      "25 TO 29",
      "30"))
  data$S2988500[20.0 <= data$S2988500 & data$S2988500 <= 999999.0] <- 20.0
  data$S2988500 <- factor(data$S2988500, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15",
      "16",
      "17",
      "18",
      "19",
      "20 TO 999999: 20+"))
  data$S2989100[15.0 <= data$S2989100 & data$S2989100 <= 999.0] <- 15.0
  data$S2989100 <- factor(data$S2989100, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 999: 15+"))
  data$S2989800[1.0 <= data$S2989800 & data$S2989800 <= 4.0] <- 1.0
  data$S2989800[5.0 <= data$S2989800 & data$S2989800 <= 9.0] <- 5.0
  data$S2989800[10.0 <= data$S2989800 & data$S2989800 <= 14.0] <- 10.0
  data$S2989800[15.0 <= data$S2989800 & data$S2989800 <= 19.0] <- 15.0
  data$S2989800[20.0 <= data$S2989800 & data$S2989800 <= 24.0] <- 20.0
  data$S2989800[25.0 <= data$S2989800 & data$S2989800 <= 29.0] <- 25.0
  data$S2989800 <- factor(data$S2989800, 
    levels=c(0.0,1.0,5.0,10.0,15.0,20.0,25.0,30.0), 
    labels=c("0",
      "1 TO 4",
      "5 TO 9",
      "10 TO 14",
      "15 TO 19",
      "20 TO 24",
      "25 TO 29",
      "30"))
  data$S4683100[20.0 <= data$S4683100 & data$S4683100 <= 999999.0] <- 20.0
  data$S4683100 <- factor(data$S4683100, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15",
      "16",
      "17",
      "18",
      "19",
      "20 TO 999999: 20+"))
  data$S4683900[15.0 <= data$S4683900 & data$S4683900 <= 999.0] <- 15.0
  data$S4683900 <- factor(data$S4683900, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 999: 15+"))
  data$S4684800[1.0 <= data$S4684800 & data$S4684800 <= 4.0] <- 1.0
  data$S4684800[5.0 <= data$S4684800 & data$S4684800 <= 9.0] <- 5.0
  data$S4684800[10.0 <= data$S4684800 & data$S4684800 <= 14.0] <- 10.0
  data$S4684800[15.0 <= data$S4684800 & data$S4684800 <= 19.0] <- 15.0
  data$S4684800[20.0 <= data$S4684800 & data$S4684800 <= 24.0] <- 20.0
  data$S4684800[25.0 <= data$S4684800 & data$S4684800 <= 29.0] <- 25.0
  data$S4684800 <- factor(data$S4684800, 
    levels=c(0.0,1.0,5.0,10.0,15.0,20.0,25.0,30.0), 
    labels=c("0",
      "1 TO 4",
      "5 TO 9",
      "10 TO 14",
      "15 TO 19",
      "20 TO 24",
      "25 TO 29",
      "30"))
  data$S6318600[20.0 <= data$S6318600 & data$S6318600 <= 999999.0] <- 20.0
  data$S6318600 <- factor(data$S6318600, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15",
      "16",
      "17",
      "18",
      "19",
      "20 TO 999999: 20+"))
  data$S6319500[15.0 <= data$S6319500 & data$S6319500 <= 999.0] <- 15.0
  data$S6319500 <- factor(data$S6319500, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 999: 15+"))
  data$S6320400[1.0 <= data$S6320400 & data$S6320400 <= 4.0] <- 1.0
  data$S6320400[5.0 <= data$S6320400 & data$S6320400 <= 9.0] <- 5.0
  data$S6320400[10.0 <= data$S6320400 & data$S6320400 <= 14.0] <- 10.0
  data$S6320400[15.0 <= data$S6320400 & data$S6320400 <= 19.0] <- 15.0
  data$S6320400[20.0 <= data$S6320400 & data$S6320400 <= 24.0] <- 20.0
  data$S6320400[25.0 <= data$S6320400 & data$S6320400 <= 29.0] <- 25.0
  data$S6320400 <- factor(data$S6320400, 
    levels=c(0.0,1.0,5.0,10.0,15.0,20.0,25.0,30.0), 
    labels=c("0",
      "1 TO 4",
      "5 TO 9",
      "10 TO 14",
      "15 TO 19",
      "20 TO 24",
      "25 TO 29",
      "30"))
  data$S8333600[20.0 <= data$S8333600 & data$S8333600 <= 999999.0] <- 20.0
  data$S8333600 <- factor(data$S8333600, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15",
      "16",
      "17",
      "18",
      "19",
      "20 TO 999999: 20+"))
  data$S8334000[15.0 <= data$S8334000 & data$S8334000 <= 999.0] <- 15.0
  data$S8334000 <- factor(data$S8334000, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 999: 15+"))
  data$S8334400[1.0 <= data$S8334400 & data$S8334400 <= 4.0] <- 1.0
  data$S8334400[5.0 <= data$S8334400 & data$S8334400 <= 9.0] <- 5.0
  data$S8334400[10.0 <= data$S8334400 & data$S8334400 <= 14.0] <- 10.0
  data$S8334400[15.0 <= data$S8334400 & data$S8334400 <= 19.0] <- 15.0
  data$S8334400[20.0 <= data$S8334400 & data$S8334400 <= 24.0] <- 20.0
  data$S8334400[25.0 <= data$S8334400 & data$S8334400 <= 29.0] <- 25.0
  data$S8334400 <- factor(data$S8334400, 
    levels=c(0.0,1.0,5.0,10.0,15.0,20.0,25.0,30.0), 
    labels=c("0",
      "1 TO 4",
      "5 TO 9",
      "10 TO 14",
      "15 TO 19",
      "20 TO 24",
      "25 TO 29",
      "30"))
  data$T0740400[20.0 <= data$T0740400 & data$T0740400 <= 999999.0] <- 20.0
  data$T0740400 <- factor(data$T0740400, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15",
      "16",
      "17",
      "18",
      "19",
      "20 TO 999999: 20+"))
  data$T0740800[15.0 <= data$T0740800 & data$T0740800 <= 999.0] <- 15.0
  data$T0740800 <- factor(data$T0740800, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 999: 15+"))
  data$T0741200[1.0 <= data$T0741200 & data$T0741200 <= 4.0] <- 1.0
  data$T0741200[5.0 <= data$T0741200 & data$T0741200 <= 9.0] <- 5.0
  data$T0741200[10.0 <= data$T0741200 & data$T0741200 <= 14.0] <- 10.0
  data$T0741200[15.0 <= data$T0741200 & data$T0741200 <= 19.0] <- 15.0
  data$T0741200[20.0 <= data$T0741200 & data$T0741200 <= 24.0] <- 20.0
  data$T0741200[25.0 <= data$T0741200 & data$T0741200 <= 29.0] <- 25.0
  data$T0741200 <- factor(data$T0741200, 
    levels=c(0.0,1.0,5.0,10.0,15.0,20.0,25.0,30.0), 
    labels=c("0",
      "1 TO 4",
      "5 TO 9",
      "10 TO 14",
      "15 TO 19",
      "20 TO 24",
      "25 TO 29",
      "30"))
  data$T2783900[20.0 <= data$T2783900 & data$T2783900 <= 999999.0] <- 20.0
  data$T2783900 <- factor(data$T2783900, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15",
      "16",
      "17",
      "18",
      "19",
      "20 TO 999999: 20+"))
  data$T2784300[15.0 <= data$T2784300 & data$T2784300 <= 999.0] <- 15.0
  data$T2784300 <- factor(data$T2784300, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 999: 15+"))
  data$T2784700[1.0 <= data$T2784700 & data$T2784700 <= 4.0] <- 1.0
  data$T2784700[5.0 <= data$T2784700 & data$T2784700 <= 9.0] <- 5.0
  data$T2784700[10.0 <= data$T2784700 & data$T2784700 <= 14.0] <- 10.0
  data$T2784700[15.0 <= data$T2784700 & data$T2784700 <= 19.0] <- 15.0
  data$T2784700[20.0 <= data$T2784700 & data$T2784700 <= 24.0] <- 20.0
  data$T2784700[25.0 <= data$T2784700 & data$T2784700 <= 29.0] <- 25.0
  data$T2784700 <- factor(data$T2784700, 
    levels=c(0.0,1.0,5.0,10.0,15.0,20.0,25.0,30.0), 
    labels=c("0",
      "1 TO 4",
      "5 TO 9",
      "10 TO 14",
      "15 TO 19",
      "20 TO 24",
      "25 TO 29",
      "30"))
  data$T4495600[20.0 <= data$T4495600 & data$T4495600 <= 999999.0] <- 20.0
  data$T4495600 <- factor(data$T4495600, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15",
      "16",
      "17",
      "18",
      "19",
      "20 TO 999999: 20+"))
  data$T4496000[15.0 <= data$T4496000 & data$T4496000 <= 999.0] <- 15.0
  data$T4496000 <- factor(data$T4496000, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 999: 15+"))
  data$T4496400[1.0 <= data$T4496400 & data$T4496400 <= 4.0] <- 1.0
  data$T4496400[5.0 <= data$T4496400 & data$T4496400 <= 9.0] <- 5.0
  data$T4496400[10.0 <= data$T4496400 & data$T4496400 <= 14.0] <- 10.0
  data$T4496400[15.0 <= data$T4496400 & data$T4496400 <= 19.0] <- 15.0
  data$T4496400[20.0 <= data$T4496400 & data$T4496400 <= 24.0] <- 20.0
  data$T4496400[25.0 <= data$T4496400 & data$T4496400 <= 29.0] <- 25.0
  data$T4496400 <- factor(data$T4496400, 
    levels=c(0.0,1.0,5.0,10.0,15.0,20.0,25.0,30.0), 
    labels=c("0",
      "1 TO 4",
      "5 TO 9",
      "10 TO 14",
      "15 TO 19",
      "20 TO 24",
      "25 TO 29",
      "30"))
  data$T6144500[20.0 <= data$T6144500 & data$T6144500 <= 999999.0] <- 20.0
  data$T6144500 <- factor(data$T6144500, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15",
      "16",
      "17",
      "18",
      "19",
      "20 TO 999999: 20+"))
  data$T6144900[15.0 <= data$T6144900 & data$T6144900 <= 999.0] <- 15.0
  data$T6144900 <- factor(data$T6144900, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 999: 15+"))
  data$T6145300[1.0 <= data$T6145300 & data$T6145300 <= 4.0] <- 1.0
  data$T6145300[5.0 <= data$T6145300 & data$T6145300 <= 9.0] <- 5.0
  data$T6145300[10.0 <= data$T6145300 & data$T6145300 <= 14.0] <- 10.0
  data$T6145300[15.0 <= data$T6145300 & data$T6145300 <= 19.0] <- 15.0
  data$T6145300[20.0 <= data$T6145300 & data$T6145300 <= 24.0] <- 20.0
  data$T6145300[25.0 <= data$T6145300 & data$T6145300 <= 29.0] <- 25.0
  data$T6145300 <- factor(data$T6145300, 
    levels=c(0.0,1.0,5.0,10.0,15.0,20.0,25.0,30.0), 
    labels=c("0",
      "1 TO 4",
      "5 TO 9",
      "10 TO 14",
      "15 TO 19",
      "20 TO 24",
      "25 TO 29",
      "30"))
  data$T7639000[20.0 <= data$T7639000 & data$T7639000 <= 999999.0] <- 20.0
  data$T7639000 <- factor(data$T7639000, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15",
      "16",
      "17",
      "18",
      "19",
      "20 TO 999999: 20+"))
  data$T7639400[15.0 <= data$T7639400 & data$T7639400 <= 999.0] <- 15.0
  data$T7639400 <- factor(data$T7639400, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10",
      "11",
      "12",
      "13",
      "14",
      "15 TO 999: 15+"))
  data$T7639800[1.0 <= data$T7639800 & data$T7639800 <= 4.0] <- 1.0
  data$T7639800[5.0 <= data$T7639800 & data$T7639800 <= 9.0] <- 5.0
  data$T7639800[10.0 <= data$T7639800 & data$T7639800 <= 14.0] <- 10.0
  data$T7639800[15.0 <= data$T7639800 & data$T7639800 <= 19.0] <- 15.0
  data$T7639800[20.0 <= data$T7639800 & data$T7639800 <= 24.0] <- 20.0
  data$T7639800[25.0 <= data$T7639800 & data$T7639800 <= 29.0] <- 25.0
  data$T7639800 <- factor(data$T7639800, 
    levels=c(0.0,1.0,5.0,10.0,15.0,20.0,25.0,30.0), 
    labels=c("0",
      "1 TO 4",
      "5 TO 9",
      "10 TO 14",
      "15 TO 19",
      "20 TO 24",
      "25 TO 29",
      "30"))
  return(data)
}

varlabels <- c("PUBID - YTH ID CODE 1997",
  "# CIGS SMOKED/DAY LAST 30 DAYS 1997",
  "# DRINKS/DAY LAST 30 DAYS 1997",
  "# DAY USE MARIJUANA LAST 30 DAYS 1997",
  "KEY!SEX (SYMBOL) 1997",
  "KEY!BDATE M/Y (SYMBOL) 1997",
  "KEY!BDATE M/Y (SYMBOL) 1997",
  "CV_SAMPLE_TYPE 1997",
  "KEY!RACE_ETHNICITY (SYMBOL) 1997",
  "# CIGS SMOKED/DAY LAST 30 DAYS 1998",
  "# DRINKS/DAY LAST 30 DAYS 1998",
  "# DAY USE MARIJUANA LAST 30 DAYS 1998",
  "# CIGS SMOKED/DAY LAST 30 DAYS 1999",
  "# DRINKS/DAY LAST 30 DAYS 1999",
  "# DAY USE MARIJUANA LAST 30 DAYS 1999",
  "# CIGS SMOKED/DAY LAST 30 DAYS 2000",
  "# DRINKS/DAY LAST 30 DAYS 2000",
  "# DAY USE MARIJUANA LAST 30 DAYS 2000",
  "# CIGS SMOKED/DAY LAST 30 DAYS 2001",
  "# DRINKS/DAY LAST 30 DAYS 2001",
  "# DAY USE MARIJUANA LAST 30 DAYS 2001",
  "# CIGS SMOKED/DAY LAST 30 DAYS 2002",
  "# DRINKS/DAY LAST 30 DAYS 2002",
  "# DAY USE MARIJUANA LAST 30 DAYS 2002",
  "# CIGS SMOKED/DAY LAST 30 DAYS 2003",
  "# DRINKS/DAY LAST 30 DAYS 2003",
  "# DAY USE MARIJUANA LAST 30 DAYS 2003",
  "# CIGS SMOKED/DAY LAST 30 DAYS 2004",
  "# DRINKS/DAY LAST 30 DAYS 2004",
  "# DAY USE MARIJUANA LAST 30 DAYS 2004",
  "# CIGS SMOKED/DAY LAST 30 DAYS 2005",
  "# DRINKS/DAY LAST 30 DAYS 2005",
  "# DAY USE MARIJUANA LAST 30 DAYS 2005",
  "# CIGS SMOKED/DAY LAST 30 DAYS 2006",
  "# DRINKS/DAY LAST 30 DAYS 2006",
  "# DAY USE MARIJUANA LAST 30 DAYS 2006",
  "# CIGS SMOKED/DAY LAST 30 DAYS 2007",
  "# DRINKS/DAY LAST 30 DAYS 2007",
  "# DAY USE MARIJUANA LAST 30 DAYS 2007",
  "# CIGS SMOKED/DAY LAST 30 DAYS 2008",
  "# DRINKS/DAY LAST 30 DAYS 2008",
  "# DAY USE MARIJUANA LAST 30 DAYS 2008",
  "# CIGS SMOKED/DAY LAST 30 DAYS 2009",
  "# DRINKS/DAY LAST 30 DAYS 2009",
  "# DAY USE MARIJUANA LAST 30 DAYS 2009",
  "# CIGS SMOKED/DAY LAST 30 DAYS 2010",
  "# DRINKS/DAY LAST 30 DAYS 2010",
  "# DAY USE MARIJUANA LAST 30 DAYS 2010",
  "# CIGS SMOKED/DAY LAST 30 DAYS 2011",
  "# DRINKS/DAY LAST 30 DAYS 2011",
  "# DAY USE MARIJUANA LAST 30 DAYS 2011"
)


# Use qnames rather than rnums

qnames = function(data) {
  names(data) <- c("PUBID_1997",
    "YSAQ-362_1997",
    "YSAQ-366_1997",
    "YSAQ-371_1997",
    "KEY_SEX_1997",
    "KEY_BDATE_M_1997",
    "KEY_BDATE_Y_1997",
    "CV_SAMPLE_TYPE_1997",
    "KEY_RACE_ETHNICITY_1997",
    "YSAQ-362_1998",
    "YSAQ-366_1998",
    "YSAQ-371_1998",
    "YSAQ-362_1999",
    "YSAQ-366_1999",
    "YSAQ-371_1999",
    "YSAQ-362_2000",
    "YSAQ-366_2000",
    "YSAQ-371_2000",
    "YSAQ-362_2001",
    "YSAQ-366_2001",
    "YSAQ-371_2001",
    "YSAQ-362_2002",
    "YSAQ-366_2002",
    "YSAQ-371_2002",
    "YSAQ-362_2003",
    "YSAQ-366_2003",
    "YSAQ-371_2003",
    "YSAQ-362_2004",
    "YSAQ-366_2004",
    "YSAQ-371_2004",
    "YSAQ-362_2005",
    "YSAQ-366_2005",
    "YSAQ-371_2005",
    "YSAQ-362_2006",
    "YSAQ-366_2006",
    "YSAQ-371_2006",
    "YSAQ-362_2007",
    "YSAQ-366_2007",
    "YSAQ-371_2007",
    "YSAQ-362_2008",
    "YSAQ-366_2008",
    "YSAQ-371_2008",
    "YSAQ-362_2009",
    "YSAQ-366_2009",
    "YSAQ-371_2009",
    "YSAQ-362_2010",
    "YSAQ-366_2010",
    "YSAQ-371_2010",
    "YSAQ-362_2011",
    "YSAQ-366_2011",
    "YSAQ-371_2011")
  return(data)
}


#********************************************************************************************************

# Remove the '#' before the following line to create a data file called "categories" with value labels. 
categories <- vallabels(new_data)

# Remove the '#' before the following lines to rename variables using Qnames instead of Reference Numbers
new_data <- qnames(new_data)
categories <- qnames(categories)

# Produce summaries for the raw (uncategorized) data file
summary(new_data)

# Remove the '#' before the following lines to produce summaries for the "categories" data file.
# categories <- vallabels(new_data)
summary(categories)

#************************************************************************************************************

setwd("C:/Users/Henrik/github_projects/equivalent-approaches/r-files")
saveRDS(new_data, file = "alc-cig-mar.Rda")
